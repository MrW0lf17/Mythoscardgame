"use strict";(self.webpackChunkcardgame=self.webpackChunkcardgame||[]).push([[5],{265:(e,a,s)=>{s.r(a),s.d(a,{default:()=>x});var t=s(43),l=s(379),n=s(3),c=s(503);const i=s.p+"static/media/fireimp.d59df647f78eebdb7675.png",d=s.p+"static/media/player_idle.4663dd925e84b516f288.png";var r=s(579);const o=100,m=100,h=10;function f(e){for(let a=e.length-1;a>0;a--){const s=Math.floor(Math.random()*(a+1));[e[a],e[s]]=[e[s],e[a]]}return e}const u=e=>{switch(null===e||void 0===e?void 0:e.toLowerCase()){case"fire":return"fire-element";case"water":return"water-element";case"air":return"air-element";case"earth":return"earth-element";case"light":return"light-element";default:return"dark-element"}},p=(e,a,s)=>{const t=document.createElement("div");t.className="damage-number",t.textContent=`-${e}`,t.style.left=`${a}px`,t.style.top=`${s}px`,document.body.appendChild(t),setTimeout((()=>t.remove()),1e3)};const x=function(e){let{boss:a,playerAbility:s}=e;const x=(0,n.d4)((e=>e.player.deck)),[v,j]=(0,t.useState)([]),[b,N]=(0,t.useState)([]),[y,g]=(0,t.useState)([]),[w,S]=(0,t.useState)([]),[k,M]=(0,t.useState)([]),[P,C]=(0,t.useState)("playerSelect"),[$,A]=(0,t.useState)(1),[L,T]=(0,t.useState)({hp:o,mana:10,characterState:"idle",emote:null}),[q,E]=(0,t.useState)({hp:m,mana:10,characterState:"idle",emote:null}),[H,_]=(0,t.useState)(3);(0,t.useEffect)((()=>{if(x.length>0){const e=f([...x]);j(e.slice(0,4))}const e=(0,c.k2)(a.name);if(e){const a=f([...e]);g(a),S(a.slice(0,4))}}),[x,a.name]);const B=(e,a)=>{a?L.mana>=e.manaCost&&(N((a=>[...a,e])),j((a=>a.filter((a=>a.id!==e.id)))),T((a=>({...a,mana:a.mana-e.manaCost})))):q.mana>=e.manaCost&&(M((a=>[...a,e])),S((a=>a.filter((a=>a.id!==e.id)))),E((a=>({...a,mana:a.mana-e.manaCost}))))},D=()=>{if(L.hp<=0||q.hp<=0){const e=L.hp>0?"Player":"Boss";alert(`${e} wins!`)}else A((e=>e+1)),C("playerSelect"),T((e=>({...e,mana:Math.min(e.mana+1,h)}))),E((e=>({...e,mana:Math.min(e.mana+1,h)}))),j(x.slice(0,4)),S(y.slice(0,4)),_((e=>Math.max(0,e-1)))};return(0,r.jsxs)("div",{className:`boss-battle ${u(a.element)}`,children:[(0,r.jsxs)("div",{className:"round-box",children:[(0,r.jsxs)("div",{className:"round-number",children:["Round ",$]}),("playerSelect"===P||"bossSelect"===P)&&(0,r.jsx)("button",{className:"end-turn-button",onClick:"playerSelect"===P?()=>{C("bossSelect")}:()=>{C("calculate"),(()=>{let e=0,a=0;const s=k.map((e=>({...e}))).sort(((e,a)=>e.defensePower-a.defensePower));b.forEach((a=>{if("Attack"===a.type){const t=document.querySelector(`[data-card-id="${a.id}"]`);if(t){t.classList.add("card-attack-right");const e=t.getBoundingClientRect();setTimeout((()=>{p(a.attackPower,e.right,e.top)}),500)}let l=a.attackPower;for(let e=0;e<s.length&&l>0;e++){const a=s[e];if("Defense"===a.type){const e=document.querySelector(`[data-card-id="${a.id}"]`);e&&e.classList.add("card-defense-impact");const s=Math.min(l,a.defensePower);l-=s,a.defensePower-=s}}e+=l}}));const t=b.map((e=>({...e}))).sort(((e,a)=>e.defensePower-a.defensePower));if(k.forEach((e=>{if("Attack"===e.type){const s=document.querySelector(`[data-card-id="${e.id}"]`);if(s){s.classList.add("card-attack-left");const a=s.getBoundingClientRect();setTimeout((()=>{p(e.attackPower,a.left,a.top)}),500)}let l=e.attackPower;for(let e=0;e<t.length&&l>0;e++){const a=t[e];if("Defense"===a.type){const e=document.querySelector(`[data-card-id="${a.id}"]`);e&&e.classList.add("card-defense-impact");const s=Math.min(l,a.defensePower);l-=s,a.defensePower-=s}}a+=l}})),e>0){const e=document.querySelector(".boss-field");null===e||void 0===e||e.classList.add("field-damage-flash"),setTimeout((()=>null===e||void 0===e?void 0:e.classList.remove("field-damage-flash")),500)}if(a>0){const e=document.querySelector(".player-field");null===e||void 0===e||e.classList.add("field-damage-flash"),setTimeout((()=>null===e||void 0===e?void 0:e.classList.remove("field-damage-flash")),500)}setTimeout((()=>{T((e=>({...e,hp:Math.max(0,e.hp-a)}))),E((a=>({...a,hp:Math.max(0,a.hp-e)}))),document.querySelectorAll(".card-attack-right, .card-attack-left").forEach((e=>e.remove()))}),1e3),N(t.filter((e=>e.defensePower>0))),M(s.filter((e=>e.defensePower>0)))})(),setTimeout((()=>{D()}),500)},children:"End Turn"})]}),(0,r.jsxs)("div",{className:"status-panel",children:[(0,r.jsxs)("div",{className:"boss-status",children:[(0,r.jsx)("h3",{children:a.name}),(0,r.jsxs)("div",{className:"hp-bar","data-label":"HP",children:[(0,r.jsx)("div",{className:"hp-fill "+(q.hp<30?"low-hp":""),style:{width:q.hp/m*100+"%"}}),(0,r.jsxs)("span",{children:[q.hp,"/",m]})]}),(0,r.jsxs)("div",{className:"mana-bar","data-label":"MP",children:[(0,r.jsx)("div",{className:"mana-fill",style:{width:q.mana/h*100+"%"}}),(0,r.jsxs)("span",{children:[q.mana,"/",h]})]})]}),(0,r.jsxs)("div",{className:"player-status",children:[(0,r.jsx)("h3",{children:"Player"}),(0,r.jsxs)("div",{className:"hp-bar","data-label":"HP",children:[(0,r.jsx)("div",{className:"hp-fill "+(L.hp<30?"low-hp":""),style:{width:L.hp/o*100+"%"}}),(0,r.jsxs)("span",{children:[L.hp,"/",o]})]}),(0,r.jsxs)("div",{className:"mana-bar","data-label":"MP",children:[(0,r.jsx)("div",{className:"mana-fill",style:{width:L.mana/h*100+"%"}}),(0,r.jsxs)("span",{children:[L.mana,"/",h]})]})]})]}),(0,r.jsxs)("div",{className:"game-area",children:[(0,r.jsxs)("div",{className:"boss-field",children:[(0,r.jsxs)("div",{className:"character-container boss-character",children:[(0,r.jsx)("img",{src:i,alt:"Fire Imp",className:"idle-animation"}),(0,r.jsx)("div",{className:`character-state character-${q.characterState}`,children:q.emote&&(0,r.jsx)("div",{className:"emote-bubble emote-active",children:q.emote})})]}),(0,r.jsx)("div",{className:"vertical-hp-bar",children:(0,r.jsx)("div",{className:"vertical-hp-fill",style:{height:q.hp/m*100+"%"}})}),(0,r.jsx)("div",{className:"field-cards",children:k.map((e=>(0,r.jsx)("div",{className:"card-container",children:(0,r.jsx)(l.A,{card:e})},e.id)))}),(0,r.jsxs)("div",{className:"field-mana-bar",children:[(0,r.jsx)("div",{className:"field-mana-fill",style:{width:q.mana/h*100+"%"}}),(0,r.jsxs)("span",{className:"field-mana-text",children:[q.mana,"/",h]}),(0,r.jsx)("div",{className:"mana-number",children:q.mana})]})]}),(0,r.jsxs)("div",{className:"player-field",children:[(0,r.jsxs)("div",{className:"character-container player-character",children:[(0,r.jsx)("img",{src:d,alt:"Player",className:"idle-animation"}),(0,r.jsx)("div",{className:`character-state character-${L.characterState}`,children:L.emote&&(0,r.jsx)("div",{className:"emote-bubble emote-active",children:L.emote})})]}),(0,r.jsx)("div",{className:"vertical-hp-bar",children:(0,r.jsx)("div",{className:"vertical-hp-fill",style:{height:L.hp/o*100+"%"}})}),(0,r.jsx)("div",{className:"field-cards",children:b.map((e=>(0,r.jsx)("div",{className:"card-container",children:(0,r.jsx)(l.A,{card:e})},e.id)))}),(0,r.jsxs)("div",{className:"field-mana-bar",children:[(0,r.jsx)("div",{className:"field-mana-fill",style:{width:L.mana/h*100+"%"}}),(0,r.jsxs)("span",{className:"field-mana-text",children:[L.mana,"/",h]}),(0,r.jsx)("div",{className:"mana-number",children:L.mana})]})]})]}),(0,r.jsx)("div",{className:"player-controls",children:(0,r.jsx)("button",{className:"ability-button",onClick:()=>{if(0===H){const e=function(e,a){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],t=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];switch(e.name){case"Phoenix Rebirth":if(0===a.hp)return{...a,hp:Math.floor(.3*a.maxHp),attackMultiplier:1.5};break;case"Tidal Surge":const e=Math.random()<.5?2:3;return{...a,manaMultiplier:e};case"Stone Skin":return{...a,shield:3};case"Wind Walker":if(s.length>0){const e=Math.floor(Math.random()*s.length),a=[...s];return a[e]={...a[e],manaCost:Math.max(0,a[e].manaCost-1)},{hand:a}}break;case"Astral Projection":if(s.length>0){const e=s[Math.floor(Math.random()*s.length)],a={...e,id:`${e.id}_projected_${Date.now()}`,isProjection:!0};return{hand:[...s,a]}}break;case"Shadow Steal":if(t.length>0){const e=t[Math.floor(Math.random()*t.length)],a={...e,id:`${e.id}_stolen_${Date.now()}`,isStolen:!0};return{hand:[...s,a]}}break;case"Nature's Blessing":return{...a,hp:Math.min(a.maxHp,a.hp+Math.floor(.2*a.maxHp)),defenseMultiplier:2};default:return a}}(s,L,v,w);T((a=>({...a,...e}))),_(s.cooldown)}},disabled:H>0,"data-cooldown":H,children:H>0?"":"A"})}),"playerSelect"===P&&(0,r.jsx)("div",{className:"player-hand",children:v.map((e=>(0,r.jsx)("div",{className:"card-container "+(L.mana<e.manaCost?"disabled":""),onClick:()=>B(e,!0),children:(0,r.jsx)(l.A,{card:e})},e.id)))}),"bossSelect"===P&&(0,r.jsx)("div",{className:"boss-hand",children:w.map((e=>(0,r.jsx)("div",{className:"card-container "+(q.mana<e.manaCost?"disabled":""),onClick:()=>B(e,!1),children:(0,r.jsx)(l.A,{card:e})},e.id)))})]})}}}]);
//# sourceMappingURL=5.3abe91f7.chunk.js.map